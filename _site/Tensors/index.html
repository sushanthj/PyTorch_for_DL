

<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">

  

  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

  <link rel="stylesheet" href="/assets/css/just-the-docs-default.css">

  

  
    <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script>
  
  <script type="text/javascript" src="/assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>PyTorch Tensors | Pytorch</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="PyTorch Tensors" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Pytorch for DL" />
<meta property="og:description" content="Pytorch for DL" />
<link rel="canonical" href="/Tensors/" />
<meta property="og:url" content="/Tensors/" />
<meta property="og:site_name" content="Pytorch" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="PyTorch Tensors" />
<script type="application/ld+json">
{"@type":"WebPage","url":"/Tensors/","headline":"PyTorch Tensors","description":"Pytorch for DL","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  

</head>

<body>
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
    <symbol id="svg-link" viewBox="0 0 24 24">
      <title>Link</title>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link">
        <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
      </svg>
    </symbol>
    <symbol id="svg-search" viewBox="0 0 24 24">
      <title>Search</title>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search">
        <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line>
      </svg>
    </symbol>
    <symbol id="svg-menu" viewBox="0 0 24 24">
      <title>Menu</title>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu">
        <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line>
      </svg>
    </symbol>
    <symbol id="svg-arrow-right" viewBox="0 0 24 24">
      <title>Expand</title>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right">
        <polyline points="9 18 15 12 9 6"></polyline>
      </svg>
    </symbol>
    <symbol id="svg-doc" viewBox="0 0 24 24">
      <title>Document</title>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file">
        <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline>
      </svg>
    </symbol>
  </svg>

  <div class="side-bar">
    <div class="site-header">
      <a href="/" class="site-title lh-tight">
  Pytorch

</a>
      <a href="#" id="menu-button" class="site-button">
        <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg>
      </a>
    </div>
    <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav">
      
        <ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">Home</a></li><li class="nav-list-item"><a href="/Basics/" class="nav-list-link">Basics</a></li><li class="nav-list-item"><a href="/intro/" class="nav-list-link">Intro</a></li><li class="nav-list-item active"><a href="/Tensors/" class="nav-list-link active">PyTorch Tensors</a></li><li class="nav-list-item"><a href="/Derivatives/" class="nav-list-link">Derivatives in PyTorch</a></li><li class="nav-list-item"><a href="/transforms_functionals/" class="nav-list-link">PyTorch Transforms and Functionals</a></li><li class="nav-list-item"><a href="/Datasets+Dataloaders/" class="nav-list-link">Datasets & Dataloaders</a></li><li class="nav-list-item"><a href="/torch.nn/" class="nav-list-link">PyTorch Models</a></li><li class="nav-list-item"><a href="/Plotting%20Loss/" class="nav-list-link">Plotting Loss Landscapes</a></li><li class="nav-list-item"><a href="/git_concepts" class="nav-list-link">Git Concepts</a></li></ul>

      
    </nav>
    <footer class="site-footer">
      This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.
    </footer>
  </div>
  <div class="main" id="top">
    <div id="main-header" class="main-header">
      
        <div class="search">
          <div class="search-input-wrap">
            <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Pytorch" aria-label="Search Pytorch" autocomplete="off">
            <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label>
          </div>
          <div id="search-results" class="search-results"></div>
        </div>
      
      
      
        <nav aria-label="Auxiliary" class="aux-nav">
          <ul class="aux-nav-list">
            
              <li class="aux-nav-list-item">
                <a href="//github.com/sushanthj" class="site-button"
                  
                >
                  Sushanth's GitHub
                </a>
              </li>
            
          </ul>
        </nav>
      
    </div>
    <div id="main-content-wrap" class="main-content-wrap">
      
        
      
      <div id="main-content" class="main-content" role="main">
        
          <details open="">
  <summary class="text-delta">
    Table of contents
  </summary>
<ol id="markdown-toc">
  <li><a href="#basics" id="markdown-toc-basics">Basics</a>    <ol>
      <li><a href="#creating-tensors" id="markdown-toc-creating-tensors">Creating Tensors</a></li>
      <li><a href="#resizing-tensors" id="markdown-toc-resizing-tensors">Resizing Tensors</a></li>
    </ol>
  </li>
  <li><a href="#numpy-and-tensor-relations" id="markdown-toc-numpy-and-tensor-relations">Numpy and Tensor relations</a></li>
  <li><a href="#broadcasting" id="markdown-toc-broadcasting">Broadcasting</a>    <ol>
      <li><a href="#creating-an-evenly-spaced-torch-tensor" id="markdown-toc-creating-an-evenly-spaced-torch-tensor">Creating an evenly spaced torch tensor</a></li>
    </ol>
  </li>
  <li><a href="#2d-and-3d-tensors-and-subscripting" id="markdown-toc-2d-and-3d-tensors-and-subscripting">2D and 3D Tensors and subscripting</a></li>
  <li><a href="#converting-tensors-from-one-type-to-another" id="markdown-toc-converting-tensors-from-one-type-to-another">Converting Tensors from one type to another</a></li>
</ol>

</details>
      <h1 id="basics">
        
        
          <a href="#basics" class="anchor-heading" aria-labelledby="basics"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Basics
        
        
      </h1>
    

<p>In PyTorch all parts of a neural net like weights, datasets, biases, outcomes and FC layers are treated as tensors.</p>

<p>One can say that a tensor is a very generalized term for any unit of data in a neural net which is capable of undergoing math operations (like vector ops)</p>
      <h2 id="creating-tensors">
        
        
          <a href="#creating-tensors" class="anchor-heading" aria-labelledby="creating-tensors"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Creating Tensors
        
        
      </h2>
    

<p>All tensors are created in the form CHW (Channel, Height, Width)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">torch</span>

<span class="c1"># three ways of initializing tensors
</span><span class="n">a</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">FloatTensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&gt;&gt; a[0] = 7
&gt;&gt; a.dtype = torch.int64
&gt;&gt; a.type = LongTensor
&gt;&gt; a.size() = torch.tensor(1,5)  # you can also try a.ndimension()
</code></pre></div></div>
      <h2 id="resizing-tensors">
        
        
          <a href="#resizing-tensors" class="anchor-heading" aria-labelledby="resizing-tensors"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Resizing Tensors
        
        
      </h2>
    
<p>Note in the last line of code above we saw that tensor ‘a’ had 1 row and 5 columns</p>

<p>Now to resize we do:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">a_col</span> <span class="o">=</span> <span class="n">a</span><span class="p">.</span><span class="n">view</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># the arguments of view dictate the no. of rows and columns respectively
</span>
<span class="n">a_col_auto</span> <span class="o">=</span> <span class="n">a</span><span class="p">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># -1 infers no. of rows after readjusting the second dim.
</span></code></pre></div></div>
      <h1 id="numpy-and-tensor-relations">
        
        
          <a href="#numpy-and-tensor-relations" class="anchor-heading" aria-labelledby="numpy-and-tensor-relations"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Numpy and Tensor relations
        
        
      </h1>
    
<p>Preferably don’t use numpy and work only with tensors in DL networks as it messes up with ONNX or TRT conversions</p>

<p>We will use the function torch.from_numpy and a.numpy()</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">torch</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>

<span class="n">torch_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">numpy_array</span> <span class="o">=</span> <span class="n">torch_tensor</span><span class="p">.</span><span class="n">numpy</span><span class="p">()</span>
<span class="n">ordinary_list</span> <span class="o">=</span> <span class="n">torch_tensor</span><span class="p">.</span><span class="n">to_list</span><span class="p">()</span>
</code></pre></div></div>
      <h1 id="broadcasting">
        
        
          <a href="#broadcasting" class="anchor-heading" aria-labelledby="broadcasting"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Broadcasting
        
        
      </h1>
    

<p>Some torch functions can be broadcast along all elements in a tensor or a list</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

<span class="o">&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></div>
      <h2 id="creating-an-evenly-spaced-torch-tensor">
        
        
          <a href="#creating-an-evenly-spaced-torch-tensor" class="anchor-heading" aria-labelledby="creating-an-evenly-spaced-torch-tensor"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Creating an evenly spaced torch tensor
        
        
      </h2>
    

<p>We can use the broadcasting feature of a tensor as we described above along with a torch function called <i> linspace</i></p>

<p>Note. linspace is also available in numpy with the function having the same name</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">torch</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">num</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="o">&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
</code></pre></div></div>
      <h1 id="2d-and-3d-tensors-and-subscripting">
        
        
          <a href="#2d-and-3d-tensors-and-subscripting" class="anchor-heading" aria-labelledby="2d-and-3d-tensors-and-subscripting"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2D and 3D Tensors and subscripting
        
        
      </h1>
    

<p>In matrices or numpy arrays, accessing individual elements is often called <strong>subscripting</strong></p>

<p>if ‘a’ is a 2D tensor, then the individual elements can be accesses as:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">a</span> <span class="o">=</span> <span class="p">[...]</span>
<span class="o">&gt;&gt;</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="c1"># 0th row and 2nd column element
</span></code></pre></div></div>
      <h1 id="converting-tensors-from-one-type-to-another">
        
        
          <a href="#converting-tensors-from-one-type-to-another" class="anchor-heading" aria-labelledby="converting-tensors-from-one-type-to-another"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Converting Tensors from one type to another
        
        
      </h1>
    

<p><img src="/images/tensor_conversion.jpeg" alt="" /></p>

        

        

        
        
          <hr>
          <footer>
            

            <p class="text-small text-grey-dk-100 mb-0"></p>

            
              <div class="d-flex mt-2">
                
                
              </div>
            
          </footer>
        

      </div>
    </div>

    
      

      <div class="search-overlay"></div>
    
  </div>
</body>
</html>

